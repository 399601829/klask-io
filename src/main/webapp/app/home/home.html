<div ng-cloak>
    <div class="col-md-2 col-lg-2">
        <div class="well">
            <div class="row">
                <!-- DEBUG
                <span>{{vm.versionsSelected}}</span>-->
                <input type="search" class="form-control ng-pristine ng-untouched ng-valid ng-not-empty"
                       ng-model="queryversion" placeholder="{{ 'researchApp.file.home.version.search' | translate }}"
                       aria-label="filter version"/>
                <ul class="list-group" ng-init="limitVersion=5;foldVersion=true">
                    <li class="rightAlign"
                        ng-repeat="version in vm.versionsOnRequest | filter:queryversion as filteredVersion ">
                        <h5>
                            <a href ng-if="$index<limitVersion || vm.isVersionIsActive(version.name)"
                               ng-class="vm.isVersionIsActive(version.name) ? 'label label-success' : 'label label-info'"
                               ng-click="vm.filterByVersion(version.name)">
                                {{version.name}}
                                <span class="badge">{{version.docNumber.toLocaleString("fr")}}</span>
                            </a>
                        </h5>
                    </li>
                    <li class="rightAlign">
                        <a href ng-show="foldVersion && filteredVersion.length > limitVersion" class="label label-info"
                           ng-click='limitVersion=100;foldVersion=!foldVersion'>...</a>
                        <a href ng-show="!foldVersion" class="label label-info"
                           ng-click='limitVersion=5;foldVersion=!foldVersion'><span
                            class="glyphicon glyphicon-triangle-top"></a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="well">
            <div class="row">
                <input type="search" class="form-control ng-pristine ng-untouched ng-valid ng-not-empty"
                       ng-model="queryproject" placeholder="{{ 'researchApp.file.home.project.search' | translate }}"
                       aria-label="filter project"/>
                <ul class="list-group" ng-init="limitProject=5;foldProject=true">
                    <li class="rightAlign"
                        ng-repeat="project in vm.projectsOnRequest | filter:queryproject as filteredProject ">
                        <h5>
                            <a href ng-if="$index<limitProject || vm.isProjectIsActive(project.name)"
                               ng-class="vm.isProjectIsActive(project.name) ? 'label label-success' : 'label label-primary'"
                               ng-click="vm.filterByProject(project.name)">
                                {{project.name}}
                                <span class="badge">{{project.docNumber.toLocaleString("fr")}}</span>
                            </a>
                        </h5>
                    </li>
                    <li class="rightAlign">
                        <a href ng-show="foldProject && filteredProject.length > limitProject"
                           class="label label-primary"
                           ng-click='limitProject=100;foldProject=!foldProject'>...</a>
                        <a href ng-show="!foldProject" class="label label-primary"
                           ng-click='limitProject=5;foldProject=!foldProject'><span
                            class="glyphicon glyphicon-triangle-top"></span></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="padding-left-zero col-md-10 col-lg-10">
        <div class="well">
            <div class="row">
                <div>
                    <jhi-alert></jhi-alert>
                    <div class="container-fluid">
                        <div class="col-xs-4">
                            <h3 class="margin-top-zero">
                                <span class="label label-primary">{{'researchApp.file.home.totalFiles' | translate}}
                                <span class="badge">{{vm.versionsOnRequest | countDocs}}</span></span>
                            </h3>
                        </div>
                        <div class="col-xs-8 no-padding-right align-right">
                            <form name="searchForm" class="form-inline">
                                <div class="input-group pull-right">
                                    <input type="text" class="form-control" ng-model="vm.searchQuery" id="searchQuery"
                                           placeholder="{{ 'researchApp.file.home.search' | translate }}">
                        <span class="input-group-btn width-min">
                            <button class="btn btn-info" ng-click="vm.search(vm.searchQuery)">
                                <span class="glyphicon glyphicon-search"></span>
                            </button>
                        </span>
                        <span class="input-group-btn width-min" ng-if="vm.currentSearch">
                            <button class="btn btn-info" ng-click="vm.clear()">
                                <span class="glyphicon glyphicon-trash"></span>
                            </button>
                        </span>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- vÃ©rifier ce qu'il y a avant cette balise -->
                <hr/>
                <div class="row">
                    <div class="container-fluid">
                        <div class="table-responsive">
                            <table class="jh-table table table-striped">
                                <thead>
                                <tr jh-sort="vm.predicate" ascending="vm.reverse" callback="vm.transition()">
                                    <th jh-sort-by="name"><span translate="researchApp.file.name">Name</span> <span
                                        class="glyphicon glyphicon-sort"></span></th>
                                    <!--<th jh-sort-by="extension"><span translate="researchApp.file.extension">Extension</span> <span
                                        class="glyphicon glyphicon-sort"></span></th>-->
                                    <th jh-sort-by="path"><span translate="researchApp.file.path">Path</span> <span
                                        class="glyphicon glyphicon-sort"></span></th>
                                    <th jh-sort-by="content"><span
                                        translate="researchApp.file.content">Content</span> <span
                                        class="glyphicon glyphicon-sort"></span></th>
                                    <th jh-sort-by="version"><span
                                        translate="researchApp.file.version">Version</span> <span
                                        class="glyphicon glyphicon-sort"></span></th>
                                    <th jh-sort-by="extension"><span translate="researchApp.file.project">Project</span> <span
                                        class="glyphicon glyphicon-sort"></span></th>
                                    <th jh-sort-by="size"><span translate="researchApp.file.size">Size</span> <span
                                        class="glyphicon glyphicon-sort"></span></th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr ng-repeat="file in vm.files track by file.id">
                                    <td colspan="6">
                                        <div>
                                            <div style="padding-bottom:2px">
                                                <a data-toggle="tooltip" data-placement="left"
                                                   title="{{file.name}}.{{file.extension}}"
                                                   ui-sref="home-detail({id:file.id})">{{file.name|
                                                    characters:25}}.{{file.extension}}</a>
                                                <span class="label label-info">{{file.version}}</span>
                                                <span class="label label-primary">{{file.project}}</span>
                                                <span class="sizeDoc">{{file.size | formatKoMoGo}}</span>
                                            </div>
                                            <p class="small" html="{{file.content | characters:460}}"></p>
                                            <em class="pathDoc small">{{file.path}}</em>
                                        </div>
                                    </td>
                                    <!-- mode tableau deprecated -->
                                    <!--<td><a data-toggle="tooltip" data-placement="left"
                                           title="{{file.name}}.{{file.extension}}"
                                           ui-sref="home-detail({id:file.id})">{{file.name|
                                        characters:25}}.{{file.extension}}</a></td>
                                    &lt;!&ndash;<td>{{file.extension}}</td>&ndash;&gt;
                                    <td data-toggle="tooltip" data-placement="left"
                                        title="{{file.path}}">{{file.path | characters:40}}
                                    </td>
                                    <td>{{file.content | characters:300}}</td>
                                    <td>{{file.version}}</td>
                                    <td>{{file.project}}</td>
                                    <td>{{file.size | formatKoMoGo}}</td>-->
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="text-center">
                            <jhi-item-count page="vm.page" total="vm.queryCount"
                                            items-per-page="vm.itemsPerPage"></jhi-item-count>
                            <uib-pagination class="pagination-sm" total-items="vm.totalItems" ng-model="vm.page"
                                            ng-change="vm.transition()"></uib-pagination>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

